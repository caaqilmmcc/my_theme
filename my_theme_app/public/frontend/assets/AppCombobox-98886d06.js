var ge=Object.defineProperty,ye=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable;var J=(e,t,i)=>t in e?ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,V=(e,t)=>{for(var i in t||(t={}))Ce.call(t,i)&&J(e,i,t[i]);if(G)for(var i of G(t))Ve.call(t,i)&&J(e,i,t[i]);return e},j=(e,t)=>ye(e,ke(t));import{b as _e,V as we}from"./VInput-47172c35.js";import{m as Ae}from"./VSelect-9e79a62e.js";import{f as De}from"./forwardRefs-bb5e4b03.js";import{m as Ie,u as Pe}from"./filter-d402a27d.js";import{m as Fe}from"./transition-79a2ac22.js";import{u as Se,t as $,V as Re,a as W}from"./VList-c07f77ee.js";import{as as Te,aA as Ee,aF as $e,k as _,aD as X,D as p,aw as Le,aK as Me,Y as L,ba as ee,az as Ne,p as c,F as oe,Z as F,bl as Be,Q as Oe,d as Ue,ar as le,o as ae,c as ze,q as M,b as Ke,B as je,aa as qe,a as He,w as Qe,n as Ye,ab as te,ac as ne,s as Ze}from"./index-dea2516e.js";import{m as Ge,V as ue}from"./VTextField-692b1cc3.js";import{V as Je}from"./VMenu-8e3d56e9.js";import{V as We}from"./VCheckboxBtn-5583829a.js";import{V as Xe}from"./VChip-f02b8801.js";function el(e,t,i){if(t==null)return e;if(Array.isArray(t))throw new Error("Multiple matches is not implemented");return typeof t=="number"&&~t?c(oe,null,[c("span",{class:"v-combobox__unmask"},[e.substr(0,t)]),c("span",{class:"v-combobox__mask"},[e.substr(t,i)]),c("span",{class:"v-combobox__unmask"},[e.substr(t+i)])]):e}const ll=Te()({name:"VCombobox",props:V(V(V(V({delimiters:Array},Ie({filterKeys:["title"]})),Ae({hideNoData:!0,returnObject:!0})),Ee(Ge({modelValue:null}),["validationValue","dirty","appendInnerIcon"])),Fe({transition:!1})),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,t){var Q,Y;let{emit:i,slots:a}=t;const{t:D}=$e(),g=_(),b=_(!1),h=_(!0),q=_(),N=X(e,"menu"),f=p({get:()=>N.value,set:l=>{var n;N.value&&!l&&((n=q.value)!=null&&n.Î¨openChildren)||(N.value=l)}}),o=_(-1);let B=!1;const se=p(()=>{var l;return(l=g.value)==null?void 0:l.color}),{items:O,transformIn:ie,transformOut:re}=Se(e),{textColorClasses:ce,textColorStyles:ve}=Le(se),d=X(e,"modelValue",[],l=>ie(Me(l)),l=>{var s;const n=re(l);return e.multiple?n:(s=n[0])!=null?s:null}),w=_e(),A=_(e.multiple?"":(Y=(Q=d.value[0])==null?void 0:Q.title)!=null?Y:""),v=p({get:()=>A.value,set:l=>{var n;if(A.value=l,e.multiple||(d.value=[$(e,l)]),l&&e.multiple&&((n=e.delimiters)!=null&&n.length)){const s=l.split(new RegExp(`(?:${e.delimiters.join("|")})+`));s.length>1&&(s.forEach(x=>{x=x.trim(),x&&C($(e,x))}),A.value="")}l||(o.value=-1),h.value=!l}});L(A,l=>{B?ee(()=>B=!1):b.value&&!f.value&&(f.value=!0),i("update:search",l)}),L(d,l=>{var n,s;e.multiple||(A.value=(s=(n=l[0])==null?void 0:n.title)!=null?s:"")});const{filteredItems:S,getMatches:de}=Pe(e,O,p(()=>h.value?void 0:v.value)),k=p(()=>d.value.map(l=>O.value.find(n=>e.valueComparator(n.value,l.value))||l)),U=p(()=>e.hideSelected?S.value.filter(l=>!k.value.some(n=>n.value===l.value)):S.value),z=p(()=>k.value.map(l=>l.props.value)),H=p(()=>k.value[o.value]),K=_();function fe(l){B=!0,e.openOnClear&&(f.value=!0)}function me(){e.hideNoData&&!O.value.length||e.readonly||w!=null&&w.isReadonly.value||(f.value=!0)}function be(l){var x,u;if(e.readonly||w!=null&&w.isReadonly.value)return;const n=g.value.selectionStart,s=z.value.length;if((o.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(f.value=!0),["Escape"].includes(l.key)&&(f.value=!1),["Enter","Escape","Tab"].includes(l.key)&&(h.value=!0),l.key==="ArrowDown"?(x=K.value)==null||x.focus("next"):l.key==="ArrowUp"&&((u=K.value)==null||u.focus("prev")),!!e.multiple){if(["Backspace","Delete"].includes(l.key)){if(o.value<0){l.key==="Backspace"&&!v.value&&(o.value=s-1);return}const r=o.value;H.value&&C(H.value),o.value=r>=s-1?s-2:r}if(l.key==="ArrowLeft"){if(o.value<0&&n>0)return;const r=o.value>-1?o.value-1:s-1;k.value[r]?o.value=r:(o.value=-1,g.value.setSelectionRange(v.value.length,v.value.length))}if(l.key==="ArrowRight"){if(o.value<0)return;const r=o.value+1;k.value[r]?o.value=r:(o.value=-1,g.value.setSelectionRange(0,0))}l.key==="Enter"&&v.value&&(C($(e,v.value)),v.value="")}}function pe(){b.value&&(h.value=!0)}function C(l){if(e.multiple){const n=z.value.findIndex(s=>e.valueComparator(s,l.value));if(n===-1)d.value=[...d.value,l];else{const s=[...d.value];s.splice(n,1),d.value=s}v.value=""}else d.value=[l],A.value=l.title,ee(()=>{f.value=!1,h.value=!0})}function he(l){b.value=!0}function xe(l){var n;l.relatedTarget==null&&((n=g.value)==null||n.focus())}return L(S,l=>{!l.length&&e.hideNoData&&(f.value=!1)}),L(b,l=>{if(l)o.value=-1;else{if(f.value=!1,!e.multiple||!v.value)return;d.value=[...d.value,$(e,v.value)],v.value=""}}),Ne(()=>{const l=!!(e.chips||a.chip),n=!!(!e.hideNoData||U.value.length||a.prepend||a.append||a["no-data"]),s=d.value.length>0,[x]=ue.filterProps(e);return c(ue,F({ref:g},x,{modelValue:v.value,"onUpdate:modelValue":[u=>v.value=u,u=>{u==null&&(d.value=[])}],focused:b.value,"onUpdate:focused":u=>b.value=u,validationValue:d.externalValue,dirty:s,class:["v-combobox",{"v-combobox--active-menu":f.value,"v-combobox--chips":!!e.chips,"v-combobox--selecting-index":o.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0},e.class],style:e.style,appendInnerIcon:e.items.length?e.menuIcon:void 0,readonly:e.readonly,placeholder:s?void 0:e.placeholder,"onClick:clear":fe,"onMousedown:control":me,onKeydown:be}),j(V({},a),{default:()=>c(oe,null,[c(Je,F({ref:q,modelValue:f.value,"onUpdate:modelValue":u=>f.value=u,activator:"parent",contentClass:"v-combobox__content",eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:pe},e.menuProps),{default:()=>[n&&c(Re,{ref:K,selected:z.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:u=>u.preventDefault(),onFocusin:he,onFocusout:xe},{default:()=>{var u,r,R,I;return[!U.value.length&&!e.hideNoData&&((r=(u=a["no-data"])==null?void 0:u.call(a))!=null?r:c(W,{title:D(e.noDataText)},null)),(R=a["prepend-item"])==null?void 0:R.call(a),U.value.map(m=>{var P,y;return(y=(P=a.item)==null?void 0:P.call(a,{item:m,props:F(m.props,{onClick:()=>C(m)})}))!=null?y:c(W,F({key:m.value},m.props,{onClick:()=>C(m)}),{prepend:T=>{let{isSelected:E}=T;return e.multiple&&!e.hideSelected?c(We,{modelValue:E,ripple:!1,tabindex:"-1"},null):void 0},title:()=>{var T,E,Z;return h.value?m.title:el(m.title,(T=de(m))==null?void 0:T.title,(Z=(E=v.value)==null?void 0:E.length)!=null?Z:0)}})}),(I=a["append-item"])==null?void 0:I.call(a)]}})]}),k.value.map((u,r)=>{var m,P;function R(y){y.stopPropagation(),y.preventDefault(),C(u)}const I={"onClick:close":R,modelValue:!0,"onUpdate:modelValue":void 0};return c("div",{key:u.value,class:["v-combobox__selection",r===o.value&&["v-combobox__selection--selected",ce.value]],style:r===o.value?ve.value:{}},[l?a.chip?c(Be,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:u.title}}},{default:()=>{var y;return[(y=a.chip)==null?void 0:y.call(a,{item:u,index:r,props:I})]}}):c(Xe,F({key:"chip",closable:e.closableChips,size:"small",text:u.title},I),null):(P=(m=a.selection)==null?void 0:m.call(a,{item:u,index:r}))!=null?P:c("span",{class:"v-combobox__selection-text"},[u.title,e.multiple&&r<k.value.length-1&&c("span",{class:"v-combobox__selection-comma"},[Oe(",")])])])})])}))}),De({isFocused:b,isPristine:h,menu:f,search:v,selectionIndex:o,filteredItems:S,select:C},g)}}),al=Ue({name:"AppCombobox",inheritAttrs:!1}),bl=Object.assign(al,{setup(e){const t=p(()=>{const a=le(),D=a.id||a.label;return D?`app-combobox-${D}-${Math.random().toString(36).slice(2,7)}`:void 0}),i=p(()=>le().label);return(a,D)=>(ae(),ze("div",{class:Ze(["app-combobox flex-grow-1",a.$attrs.class])},[M(i)?(ae(),Ke(we,{key:0,for:M(t),class:"mb-1 text-body-2 text-high-emphasis",text:M(i)},null,8,["for","text"])):je("",!0),c(ll,te(ne(j(V({},a.$attrs),{class:null,label:void 0,variant:"outlined",id:M(t),menuProps:{contentClass:["app-inner-list","app-combobox__content","v-combobox__content",a.$attrs.multiple!==void 0?"v-list-select-multiple":""]}}))),qe({_:2},[He(a.$slots,(g,b)=>({name:b,fn:Qe(h=>[Ye(a.$slots,b,te(ne(h||{})))])}))]),1040)],2))}});export{ll as V,bl as _};
